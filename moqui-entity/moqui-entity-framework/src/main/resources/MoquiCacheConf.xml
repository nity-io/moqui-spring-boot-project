<?xml version="1.0" encoding="UTF-8" ?>
<!-- No copyright or license for configuration file, details here are not considered a creative work. -->
<moqui-conf xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/moqui-conf-2.1.xsd">

    <!-- Settings in this file can be overridden in a component (MoquiConf.xml) and/or runtime conf file that has
        any of the desired sub-elements. -->

    <!-- Default properties are only set if there is no Java property or environment variable of the same name (or with underscores replaced by dots) -->

    <!-- recommended values: production, dev, test; any code may look at these Java System properties to vary behavior (System.getProperty("instance_purpose")) -->
    <default-property name="instance_purpose" value="production"/>

    <default-property name="default_locale" value="en_US"/>
    <default-property name="default_time_zone" value="US/Pacific"/>
    <default-property name="database_time_zone" value="US/Pacific"/>

    <default-property name="webapp_http_host" value=""/>
    <default-property name="webapp_http_port" value=""/>
    <default-property name="webapp_https_port" value=""/>
    <default-property name="webapp_https_enabled" value="false"/>

    <default-property name="entity_ds_db_conf" value="h2"/>
    <default-property name="entity_ds_host" value="localhost"/>
    <default-property name="entity_ds_port" value=""/>
    <default-property name="entity_ds_database" value="moqui"/>
    <default-property name="entity_ds_url" value="jdbc:h2:${moqui_runtime}/db/h2/${entity_ds_database};lock_timeout=30000"/>
    <default-property name="entity_ds_schema" value=""/>
    <default-property name="entity_ds_user" value="sa"/>
    <default-property name="entity_ds_password" value="sa"/>
    <default-property name="entity_ds_crypt_pass" value="MoquiDefaultPassword:CHANGEME"/>
    <default-property name="entity_add_missing_runtime" value=""/>
    <default-property name="entity_add_missing_startup" value=""/>

    <tools empty-db-load="seed,seed-initial,install" worker-queue="65535" worker-pool-core="4" worker-pool-max="16" worker-pool-alive="60">
        <tool-factory class="org.moqui.cache.impl.tools.MCacheToolFactory" init-priority="03" disabled="false"/>
    </tools>

    <cache-list warm-on-start="true" local-factory="MCache" distributed-factory="MCache">
        <!-- Entity Database Record Caches (and cache clear assist data) -->
        <!-- set type="distributed" to use the distributed cache -->
        <cache name="entity.record.one." max-elements="20000" eviction-strategy="least-frequently-used"
                key-type="org.moqui.entity.EntityCondition" value-type="org.moqui.impl.entity.EntityValueBase"/>
        <cache name="entity.record.list." max-elements="10000" eviction-strategy="least-frequently-used"
                key-type="org.moqui.entity.EntityCondition" value-type="org.moqui.impl.entity.EntityListImpl"/>
        <cache name="entity.record.count." max-elements="10000" eviction-strategy="least-frequently-used"
                key-type="org.moqui.entity.EntityCondition" value-type="Long"/>

        <cache name="entity.record.one_ra." max-elements="40000" eviction-strategy="least-frequently-used"
                key-type="org.moqui.entity.EntityCondition" value-type="Set"/>
        <cache name="entity.record.one_view_ra." max-elements="40000" eviction-strategy="least-frequently-used"
                key-type="org.moqui.entity.EntityCondition" value-type="Set"/>
        <cache name="entity.record.one_bf" max-elements="1000" eviction-strategy="least-frequently-used"
                value-type="Set"/>

        <cache name="entity.record.list_ra." max-elements="20000" eviction-strategy="least-frequently-used"
                key-type="org.moqui.entity.EntityCondition" value-type="Set"/>
        <cache name="entity.record.list_view_ra." max-elements="20000" eviction-strategy="least-frequently-used"
                key-type="org.moqui.entity.EntityCondition" value-type="Set"/>

        <!-- Framework configuration and artifact caches -->
        <!-- NOTE: Production mode by default - No expiration of conf and impl artifacts. -->

        <cache name="entity.definition" value-type="org.moqui.impl.entity.EntityDefinition"/>
        <cache name="entity.location" value-type="Map"/>
        <cache name="entity.sequence.bank" value-type="long[]"/>
        <!-- this is info for each entity for real-time push DataFeeds; expires every 15 min to get DataFeed and DataDocument updates -->
        <cache name="entity.data.feed.info" expire-time-live="900" value-type="ArrayList"/>

        <cache name="service.location" value-type="org.moqui.impl.service.ServiceDefinition"/>
        <cache name="service.rest.api" value-type="org.moqui.impl.service.RestApi$ResourceNode"/>
        <cache name="kie.component.releaseId" value-type="org.kie.api.builder.ReleaseId"/>
        <cache name="kie.session.component" value-type="String"/>

        <cache name="screen.location" value-type="org.moqui.impl.screen.ScreenDefinition"/>
        <cache name="screen.location.perm" value-type="org.moqui.impl.screen.ScreenDefinition"/>
        <cache name="screen.url" value-type="org.moqui.impl.screen.ScreenUrlInfo"/>
        <cache name="screen.info" value-type="List"/>
        <cache name="screen.info.ref.rev" value-type="Set"/>
        <cache name="screen.template.mode" value-type="freemarker.template.Template"/>
        <cache name="screen.template.location" value-type="freemarker.template.Template"/>
        <cache name="widget.template.location" value-type="MNode"/>
        <cache name="screen.find.path" value-type="ArrayList"/>
        <cache name="screen.form.db.node" value-type="MNode"/>

        <cache name="resource.xml-actions.location" value-type="org.moqui.impl.actions.XmlAction"/>
        <cache name="resource.groovy.location" value-type="java.lang.Class"/>
        <cache name="resource.javascript.location" value-type="java.lang.Class"/>

        <!-- These caches must be local caches (use additional methods on MCache not in javax.cache.Cache) -->
        <cache name="resource.ftl.location" value-type="freemarker.template.Template" type="local"/>
        <cache name="resource.gstring.location" value-type="groovy.text.Template" type="local"/>
        <cache name="resource.wiki.location" value-type="String" type="local"/>
        <cache name="resource.markdown.location" value-type="String" type="local"/>
        <cache name="resource.text.location" value-type="String" type="local"/>

        <cache name="resource.reference.location" value-type="org.moqui.resource.ResourceReference"/>

        <cache name="l10n.message" expire-time-idle="3600" max-elements="50000" value-type="String"/>

        <!-- this is a count of all artifact hits, expire once idle for over 15 minutes -->
        <cache name="artifact.tarpit.hits" expire-time-idle="900" max-elements="10000" value-type="ArrayList"/>
    </cache-list>

</moqui-conf>
